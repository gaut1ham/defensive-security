# Educational purpose only
# Simple log anomaly detector

from collections import defaultdict

LOG_FILE = "sample.log"
THRESHOLD = 3

failed_attempts = defaultdict(int)

with open(LOG_FILE, "r") as file:
    for line in file:
        if "FAILED_LOGIN" in line:
            ip = line.split()[-1]
            failed_attempts[ip] += 1

print("⚠️ Suspicious IPs:")
for ip, count in failed_attempts.items():
    if count >= THRESHOLD:
        print(f"{ip} → {count} failed attempts")
